@using System.Configuration
@using OurUmbraco.Our
@using OurUmbraco.Our.Models
@inherits OurUmbracoTemplatePage
@{

    var homeNotificationText = Model.Content.GetPropertyValue<string>("homeOnlyBanner");
    var showHomeNotification = string.IsNullOrWhiteSpace(homeNotificationText) == false;
    var globalNotificationText = Model.Content.GetPropertyValue<string>("mainNotification");
    var showGlobalNotification = string.IsNullOrWhiteSpace(globalNotificationText) == false;
}
<!-- Search start -->
<section id="search-all" class="search-all">

    <div class="search-all-form">
        <div class="search-fieldset">
            <input class="search-input" type="search" placeholder="Search..">
            <input class="search-submit" type="submit" value="&#xe085;">
        </div>
        <span class="search-all-close"></span>
    </div>

    <div class="search-all-results equalizer">
        <ul></ul>
    </div>

    @if (MemberData == null)
    {
        <div class="search-text">
            <div class="container">
                <div class="row">
                    <div class="col-md-6 col-md-offset-3">
                        <strong>The friendliest CMS community on the planet</strong>
                        <p>our.umbraco.org is the central hub for the friendly umbraco community. Search for documentation, get help and guidance from seasoned experts, download and collaborate on plugins and extensions.</p>
                    </div>
                </div>
            </div>
        </div>
    }

</section>
<!-- Search end -->

<style>
    .bannertext p {
        line-height: 1.4rem;
    }
</style>

@if (showGlobalNotification)
{
    <div class="alertbar__yellow">
        @Html.Raw(globalNotificationText)
    </div>
}

@if (showHomeNotification)
{
    @Html.Raw(homeNotificationText)
}

@if (Members.IsLoggedIn())
{
    @HighFiveActivity()
    @ForumActivity()
    @Gitter()
    @Meetups()
    @GitHubContributors()
    @TwitterSearch()
    @Html.Partial("home/documentation")
}
else
{
    @Html.Partial("home/documentation")
    @ForumActivity()
    @Gitter()
    @Meetups()
    @GitHubContributors()
    @TwitterSearch()
}

@helper HighFiveActivity()
    {
        <section class="high-five" data-high-five>
            <div class="container">
                <div class="row">

                    <div class="col-md-12">
                        <h1 class="text-center">Community Activity</h1>
                    </div>
                    <div class="col-md-12">
                        <form id="high-five-form">
                            <h3>
                                High Five <input type="text" id="high-five-mention" class="high-five-field" />
                                for <select class="high-five-field" id="high-five-task">
                                    <option value="" disabled selected>...</option>
                                    <option>Advice</option>
                                    <option>Blog Post</option>
                                    <option>Meetup</option>
                                    <option>Package</option>
                                    <option>Skrift Article</option>
                                    <option>Talk</option>
                                    <option>Tutorial</option>
                                    <option>Video</option>
                                </select> at
                                <input type="text" id="high-five-url" placeholder="https://skrift.io" class="high-five-field" />
                                <button id="high-five-submit" class="button green high-five-submit" value="High Five">
                                    <img src="/assets/images/highfive.svg" alt="high five"> Send
                                </button>
                            </h3>
                            <!--                            <p>
                                                            <a class="button green high-five" href="/forum">High Five</a>
                                                        </p>
                            -->
                        </form>
                    </div>
                    <div class="col-md-12" id="high-five-activity">
                        <h2 class="text-center">Latest Community Activity</h2>
                        <ul class="high-five-activity-list"></ul>
                        <!--<h2>Loading latest community activity...</h2>
                        
                        <ul class="umb-load-indicator animated -half-second">
                            <li class="umb-load-indicator__bubble"></li>
                            <li class="umb-load-indicator__bubble"></li>
                            <li class="umb-load-indicator__bubble"></li>
                        </ul>
                        <a class="button green" href="/forum">All Activity &rarr;</a>
                        -->
                    </div>

                </div>
            </div>
        </section>
        <script type="text/javascript">
            var placeholderNames = [
                "Marcin Zajkowski",
                "Callum Whyte",
                "Anders Bjerner",
                "Emma Garland",
                "Lars - Erik Aabech",
                "Matt Brailsford",
                "Carole Rennie Logan",
                "Emma Burstow",
                "Lee Kelleher",
                "Jeffrey Schoemaker",
                "Erica Quessenberry",
                "Kyle Weems",
                "Mike Masey",
                "Niels Hartvig",
                "Jeavon Leopold",
                "Damiaan Peeters",
                "Marc Goodson",
                "Mads Rasmussen",
                "Shannon Deminick",
                "Stéphane Gay",
                "Sebastiaan Janssen",
                "Jacob Midtgaard - Olesen",
                "Ilham Boulghallat"];   

            $(document).ready(function () {
                printPhrases(shuffle(placeholderNames), $('#high-five-mention'));
            });
        </script>
}

@helper ForumActivity()
    {
        <section class="forum">
            <div class="container">
                <div class="row">

                    <div class="col-md-12">
                        <h1 class="text-center">Forum Activity</h1>
                        <p>
                            Recent activity in the forums, where people are helping each other with current problems.
                        </p>
                    </div>
                    <div class="col-md-12">
                        <small>Recent posts</small>
                    </div>

                    <div class="col-md-12 flex" id="forum-activity">
                        <h2>Loading latest forum activity...</h2>
                        <ul class="umb-load-indicator animated -half-second">
                            <li class="umb-load-indicator__bubble"></li>
                            <li class="umb-load-indicator__bubble"></li>
                            <li class="umb-load-indicator__bubble"></li>
                        </ul>
                    </div>

                    <div class="col-md-12 goto-forum">
                        <a class="button green" href="/forum">Go to Forum &rarr;</a>
                    </div>

                </div>
            </div>
        </section>
}

@helper TwitterSearch()
    {
        <section class="forum">
            <div class="container">
                <div class="row">

                    <div class="col-md-12">
                        <h1 class="text-center">Twitter Activity</h1>
                        <p>
                            Recent activity on twitter, where people are talking about Umbraco.
                        </p>
                    </div>
                    <div class="col-md-12">
                        <small>Recent tweets</small>
                    </div>

                    <div class="col-md-12 flex" id="twitter-search">
                        <h2>Loading twitter search results...</h2>
                        <ul class="umb-load-indicator animated -half-second">
                            <li class="umb-load-indicator__bubble"></li>
                            <li class="umb-load-indicator__bubble"></li>
                            <li class="umb-load-indicator__bubble"></li>
                        </ul>
                    </div>

                    <div class="col-md-12 goto-forum">
                        <a class="button green" href="https://twitter.com/search?f=tweets&vertical=default&q=umbraco&src=typd">Join the conversation on Twitter &rarr;</a>
                    </div>

                </div>
            </div>
        </section>
}

@helper  GitHubContributors()
    {
        <section class="forum github-contributions">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <h1 class="text-center">GitHub Contributions</h1>
                        <p>
                            <small class="github-repo-list">
                                Contributions to default branches for
                                <a href="https://github.com/umbraco/Umbraco-CMS" target="_blank" title="Umbraco-CMS">Umbraco-CMS</a>,
                                <a href="https://github.com/umbraco/UmbracoDocs" target="_blank" title="UmbracoDocs">UmbracoDocs</a>,
                                <a href="https://github.com/umbraco/OurUmbraco" target="_blank" title="OurUmbraco">OurUmbraco</a>,
                                <a href="https://github.com/umbraco/Umbraco.Deploy.Contrib" target="_blank" title="Umbraco.Deploy.Contrib">Umbraco.Deploy.Contrib</a>,
                                <a href="https://github.com/umbraco/Umbraco.Courier.Contrib" target="_blank" title="Umbraco.Courier.Contrib">Umbraco.Courier.Contrib</a> and
                                <a href="https://github.com/umbraco/Umbraco.Deploy.ValueConnectors" target="_blank" title="Umbraco.Deploy.ValueConnectors">Umbraco.Deploy.ValueConnectors</a> repos
                            </small>
                        </p>
                    </div>
                    <div class="col-md-12">
                        <small>Contributions the last 12 months (number indicating accepted commits)</small>
                    </div>

                    <div class="col-md-12 flex" id="github-contributors">
                        <h2>Loading GitHub contributors...</h2>
                        <ul class="umb-load-indicator animated -half-second">
                            <li class="umb-load-indicator__bubble"></li>
                            <li class="umb-load-indicator__bubble"></li>
                            <li class="umb-load-indicator__bubble"></li>
                        </ul>
                    </div>

                    <div class="col-md-12 goto-forum">
                        <a class="button green" href="https://our.umbraco.org/contribute">Contribute to Umbraco &rarr;</a>
                    </div>

                </div>
            </div>
        </section>
}

@helper Meetups()
    {
        <section class="forum">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <h1 class="text-center">Meetups</h1>
                        <p>
                            Upcoming meetups organized by the Umbraco community.
                        </p>
                    </div>
                    <div class="col-md-12">
                        <small>Upcoming meetups</small>
                    </div>
                    <div class="col-md-12 flex" id="meetups">
                        <h2>Loading meetups...</h2>
                        <ul class="umb-load-indicator animated -half-second">
                            <li class="umb-load-indicator__bubble"></li>
                            <li class="umb-load-indicator__bubble"></li>
                            <li class="umb-load-indicator__bubble"></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
}

@helper Gitter()
    {
        var featuresService = new UpcomingFeaturesService();
        var allowed = featuresService.MemberHasAccessToFeature();

        bool unhideGitter;
        bool.TryParse(ConfigurationManager.AppSettings["UnhideGitter"], out unhideGitter);
        if (unhideGitter || allowed)
        {
            @Html.Action("RenderGitterRoom", "GitterRoomSurface", new { roomName = "umbraco/Umbraco-CMS", viewName = "GitterHome.cshtml" })
        }
}